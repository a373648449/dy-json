<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Model List</title>
    <style>
        .search-box {
            margin-bottom: 20px;
        }

        .model-list {
            display: flex;
            flex-wrap: wrap;
        }

        .model-item {
            width: 300px;
            margin-right: 20px;
            margin-bottom: 20px;
            padding: 10px;
            border: 1px solid #ccc;
            box-sizing: border-box;
        }

        .model-item img {
            max-width: 100%;
            height: auto;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
<div class="search-box">
    <label for="search-id">Search by ID:</label>
    <input type="text" id="search-id" name="search-id">
    <button id="search-button">Search</button>
</div>
<div class="model-list"></div>
<button id="prev-button">上一页</button>
<button id="next-button">下一页</button>

<script>
    let page = 1;
    const modelList = document.querySelector(".model-list");
    const searchButton = document.querySelector("#search-button");
    const searchInput = document.querySelector("#search-id");
    const prevButton = document.querySelector("#prev-button");
    const nextButton = document.querySelector("#next-button");

    // Function to fetch data from API and display the results
    function displayModels() {
        const limit = 100;
        const apiURL = `https://civitai.com/api/v1/models?page=${page}&limit=${limit}`;

        fetch(apiURL)
            .then((response) => response.json())
            .then((data) => {
                modelList.innerHTML = "";
                data.items.forEach((item) => {
                    if (!item.nsfw) {
                        const modelItem = document.createElement("div");
                        modelItem.classList.add("model-item");

                        const modelImage = document.createElement("img");
                        modelImage.src = item.modelVersions[0].images[0].url;
                        modelItem.appendChild(modelImage);

                        const modelName = document.createElement("h2");
                        modelName.innerText = item.name;
                        modelItem.appendChild(modelName);

                        const modelID = document.createElement("p");
                        modelID.innerText = "ID: " + item.id;
                        modelItem.appendChild(modelID);

                        const downloadLink = document.createElement("a");
                        downloadLink.classList.add("download-button");
                        downloadLink.setAttribute("href", item.modelVersions[0].downloadUrl);
                        downloadLink.setAttribute("download", item.modelVersions[0].filename);
                        downloadLink.innerText = "Download";
                        modelItem.appendChild(downloadLink);

                        modelList.appendChild(modelItem);
                    }
                });
            });

    }

    // Function to filter models by ID
    function searchModels() {
        const searchID = searchInput.value;
        fetch(apiURL)
            .then((response) => response.json())
            .then((data) => {
                modelList.innerHTML = "";
                data.items.forEach((item) => {
                    if (item.id == searchID && !item.nsfw) {
                        const modelItem = document.createElement("div");
                        modelItem.classList.add("model-item");

                        const modelImage = document.createElement("img");
                        modelImage.src = item.modelVersions[0].images[0].url;
                        modelItem.appendChild(modelImage);

                        const modelName = document.createElement("h2");
                        modelName.innerText = item.name;
                        modelItem.appendChild(modelName);

                        const modelID = document.createElement("p");
                        modelID.innerText = "ID: " + item.id;
                        modelItem.appendChild(modelID);

                        const downloadLink = document.createElement("a");
                        downloadLink.classList.add("download-button");
                        downloadLink.setAttribute("href", item.modelVersions[0].downloadUrl);
                        downloadLink.setAttribute("download", item.modelVersions[0].filename);
                        downloadLink.innerText = "Download";
                        modelItem.appendChild(downloadLink);

                        modelList.appendChild(modelItem);
                    }
                });
            });
    }


    function prevPage() {
        if (page > 1) {
            page--;
            displayModels();
        }
    }

    function nextPage() {
        page++;
        displayModels();
    }

    displayModels();

    searchButton.addEventListener("click", searchModels);
    prevButton.addEventListener("click", prevPage);
    nextButton.addEventListener("click", nextPage);

    searchInput.addEventListener("keydown", (event) => {
        if (event.key === "Enter") {
            searchModels();
        }
    });
</script>
</body>
